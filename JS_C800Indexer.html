<button type="button" onclick="Reset()">Reset</button>

<body onload="Compute()">

Level dimension: 
<select id="LevelDimensionSettings" onchange="Compute()">
<option value=0>00: Height=01B tiles, MaxHScreens=20</option>
<option value=1>01: Height=01C tiles, MaxHScreens=20</option>
<option value=2>02: Height=01D tiles, MaxHScreens=1E</option>
<option value=3>03: Height=020 tiles, MaxHScreens=1C</option>
<option value=4>04: Height=022 tiles, MaxHScreens=1A</option>
<option value=5>05: Height=025 tiles, MaxHScreens=18</option>
<option value=6>06: Height=026 tiles, MaxHScreens=17</option>
<option value=7>07: Height=028 tiles, MaxHScreens=16</option>
<option value=8>08: Height=02A tiles, MaxHScreens=15</option>
<option value=9>09: Height=02C tiles, MaxHScreens=14</option>
<option value=10>0A: Height=02F tiles, MaxHScreens=13</option>
<option value=11>0B: Height=031 tiles, MaxHScreens=12</option>
<option value=12>0C: Height=034 tiles, MaxHScreens=11</option>
<option value=13>0D: Height=038 tiles, MaxHScreens=10</option>
<option value=14>0E: Height=03B tiles, MaxHScreens=0F</option>
<option value=15>0F: Height=040 tiles, MaxHScreens=0E</option>
<option value=16>10: Height=044 tiles, MaxHScreens=0D</option>
<option value=17>11: Height=04A tiles, MaxHScreens=0C</option>
<option value=18>12: Height=051 tiles, MaxHScreens=0B</option>
<option value=19>13: Height=059 tiles, MaxHScreens=0A</option>
<option value=20>14: Height=063 tiles, MaxHScreens=09</option>
<option value=21>15: Height=070 tiles, MaxHScreens=08</option>
<option value=22>16: Height=080 tiles, MaxHScreens=07</option>
<option value=23>17: Height=095 tiles, MaxHScreens=06</option>
<option value=24>18: Height=0B3 tiles, MaxHScreens=05</option>
<option value=25>19: Height=0E0 tiles, MaxHScreens=04</option>
<option value=26>1A: Height=12A tiles, MaxHScreens=03</option>
<option value=27>1B: Height=1C0 tiles, MaxHScreens=02</option>
<option value=28>1C: Height=380 tiles, MaxHScreens=01</option>
</select>

Total number of blocks in level: <span id="TotalBlocks"></span>
<hr>
<h1>Convert coordinate to $7EC800/$7FC800 indexing</h1>
<kbd>X: $</kbd><input type="text" id="BlockXPos" value ="0" maxlength="4" onchange="Compute()"><button type="button" onclick="IncreaseXPos()">+</button><button type="button" onclick="DecreaseXPos()">-</button><br>
<kbd>Y: $</kbd><input type="text" id="BlockYPos" value ="0" maxlength="4" onchange="Compute()"><button type="button" onclick="IncreaseYPos()">+</button><button type="button" onclick="DecreaseYPos()">-</button><br>
<kbd><span id="CoordsToIndex"></span></kbd>
<hr>
<h1>Convert $7EC800/$7FC800 index to coordinate</h1>
<kbd>Block index: $</kbd><input type="text" id="BlockIndex" value ="0" maxlength="4" onchange="Compute()"><button type="button" onclick="IncreaseBlockIndex()">+</button><button type="button" onclick="DecreaseBlockIndex()">-</button><br>
<kbd><span id="IndexToCoords"></span></kbd>
<script>
	function Reset() {
		document.getElementById("LevelDimensionSettings").value = 0
		document.getElementById("BlockXPos").value = 0
		document.getElementById("BlockYPos").value = 0
		document.getElementById("BlockIndex").value = 0
		Compute()
	}
	function IncreaseXPos() {
		var BlockXPosition = parseInt(document.getElementById("BlockXPos").value, 16)
		if (isNaN(BlockXPosition) == true) {
			BlockXPosition = 0
		}
		if (BlockXPosition < 65535)
			BlockXPosition++
		document.getElementById("BlockXPos").value = BlockXPosition.toString(16)
		Compute()
	}
	function DecreaseXPos() {
		var BlockXPosition = parseInt(document.getElementById("BlockXPos").value, 16)
		if (isNaN(BlockXPosition) == true) {
			BlockXPosition = 0
		}
		if (BlockXPosition > 0)
			BlockXPosition--
		document.getElementById("BlockXPos").value = BlockXPosition.toString(16)
		Compute()
	}
	function IncreaseYPos() {
		var BlockYPosition = parseInt(document.getElementById("BlockYPos").value, 16)
		if (isNaN(BlockYPosition) == true) {
			BlockYPosition = 0
		}
		if (BlockYPosition < 65535)
			BlockYPosition++
		document.getElementById("BlockYPos").value = BlockYPosition.toString(16)
		Compute()
	}
	function DecreaseYPos() {
		var BlockYPosition = parseInt(document.getElementById("BlockYPos").value, 16)
		if (isNaN(BlockYPosition) == true) {
			BlockYPosition = 0
		}
		if (BlockYPosition > 0) {
			BlockYPosition--
		}
		document.getElementById("BlockYPos").value = BlockYPosition.toString(16)
		Compute()
	}
	function IncreaseBlockIndex() {
		var BlockIndexer = parseInt(document.getElementById("BlockIndex").value, 16)
		if (isNaN(BlockIndexer) == true) {
			BlockIndexer = 0
		}
		if (BlockIndexer < 14335) {
			BlockIndexer++
		}
		document.getElementById("BlockIndex").value = BlockIndexer.toString(16)
		Compute()
	}
	function DecreaseBlockIndex() {
		var BlockIndexer = parseInt(document.getElementById("BlockIndex").value, 16)
		if (isNaN(BlockIndexer) == true) {
			BlockIndexer = 0
		}
		if (BlockIndexer > 0) {
			BlockIndexer--
		}
		document.getElementById("BlockIndex").value = BlockIndexer.toString(16)
		Compute()
	}
	function Compute() {
		//Coords -> Index
			//This prevents re-concatenating by clearing the output first
			//to make it instead replace.
				var CoordsToIndexOutput = ""
				document.getElementById("CoordsToIndex").innerHTML = ""
			//Level width and height in units of blocks.
				var LevelWidth = [
					"200",
					"200",
					"1E0",
					"1C0",
					"1A0",
					"180",
					"170",
					"160",
					"150",
					"140",
					"130",
					"120",
					"110",
					"100",
					"0F0",
					"0E0",
					"0D0",
					"0C0",
					"0B0",
					"0A0",
					"090",
					"080",
					"070",
					"060",
					"050",
					"040",
					"030",
					"020",
					"010"
				]
				var LevelHeight = [
					"01B",
					"01C",
					"01D",
					"020",
					"022",
					"025",
					"026",
					"028",
					"02A",
					"02C",
					"02F",
					"031",
					"034",
					"038",
					"03B",
					"040",
					"044",
					"04A",
					"051",
					"059",
					"063",
					"070",
					"080",
					"095",
					"0B3",
					"0E0",
					"12A",
					"1C0",
					"380"
				]
			var WhatLevelDimensionSetting = parseInt(document.getElementById("LevelDimensionSettings").value, 10)
			//Total blocks:
				var TotalBlocksInLevel = parseInt(LevelWidth[WhatLevelDimensionSetting], 16) * parseInt(LevelHeight[WhatLevelDimensionSetting], 16)
				document.getElementById("TotalBlocks").innerHTML = TotalBlocksInLevel + " ($" + TotalBlocksInLevel.toString(16) + "), index up to $" + (TotalBlocksInLevel-1).toString(16)
			//Correct values input
				var BlockXPosition = parseInt(document.getElementById("BlockXPos").value, 16)
				if (isNaN(BlockXPosition) == false) {
					BlockXPosition = clamp(BlockXPosition, 0, 65535)
					document.getElementById("BlockXPos").value = BlockXPosition.toString(16)
				}
				var BlockYPosition = parseInt(document.getElementById("BlockYPos").value, 16)
				if (isNaN(BlockYPosition) == false) {
					BlockYPosition = clamp(BlockYPosition, 0, 65535)
					document.getElementById("BlockYPos").value = BlockYPosition.toString(16)
				}
				
				var IsNumber = 0
				if ((isNaN(BlockXPosition) == false) && (isNaN(BlockYPosition) == false)) {
					IsNumber = 1
				}
				
				if (IsNumber != 0) {
					//Check if position is outside of level:
						
						var OffLevel = 0
						if ((BlockXPosition >= parseInt(LevelWidth[WhatLevelDimensionSetting], 16))||(BlockYPosition >= parseInt(LevelHeight[WhatLevelDimensionSetting], 16))) {
							OffLevel = 1
						}
					//Compute the index
						if (OffLevel == 0) {
							var BlocksPerScreenCol = parseInt(LevelHeight[WhatLevelDimensionSetting], 16) * 16
							var ScreenColumnPassed = Math.floor(BlockXPosition/16)
							
							var Index = (BlocksPerScreenCol*ScreenColumnPassed) + (BlockYPosition*16) + (BlockXPosition % 16)
							
							CoordsToIndexOutput += "Index: $" + Index.toString(16) + "<br>"
							CoordsToIndexOutput += "RAM location (in banks $7E/$7F or $40/$41): $" + (51200 + Index).toString(16) + " ($c800 + $" + Index.toString(16) + ")"
						}
				}
				if (BlockXPosition >= parseInt(LevelWidth[WhatLevelDimensionSetting], 16)) {
					CoordsToIndexOutput += "<font color='red'>Block X position is outside the level (X = $0 to X = $" + (parseInt(LevelWidth[WhatLevelDimensionSetting], 16) -1).toString(16) + " is valid).<br></font>"
				}
				if (BlockYPosition >= parseInt(LevelHeight[WhatLevelDimensionSetting], 16)) {
					CoordsToIndexOutput += "<font color='red'>Block Y position is outside the level (Y = $0 to Y = $" + (parseInt(LevelHeight[WhatLevelDimensionSetting], 16) -1).toString(16) + " is valid).<br></font>"
				}
				//Output:
					document.getElementById("CoordsToIndex").innerHTML = CoordsToIndexOutput
				
		//Handle Index -> Coords
			//This prevents re-concatenating by clearing the output first
			//to make it instead replace.
				var IndexToCoordsOutput = ""
				document.getElementById("IndexToCoords").innerHTML = ""
			//Correct index
				var BlockIndexer = parseInt(document.getElementById("BlockIndex").value, 16)
				if (isNaN(BlockIndexer) == false) {
					BlockIndexer = clamp(BlockIndexer, 0, 14335)
					document.getElementById("BlockIndex").value = BlockIndexer.toString(16)
					
					//Check if index would point to beyond the last block in level
						var TotalNumberOfBlocksInLevel = parseInt(LevelWidth[WhatLevelDimensionSetting], 16) * parseInt(LevelHeight[WhatLevelDimensionSetting], 16)
						if (BlockIndexer < TotalNumberOfBlocksInLevel) {
							//Convert to coordinates
								var WhatLevelDimensionSetting = parseInt(document.getElementById("LevelDimensionSettings").value, 10)
								var BlocksPerScreenCol = parseInt(LevelHeight[WhatLevelDimensionSetting], 16) * 16
								
								var ScreenColumnPassed = Math.floor(BlockIndexer/BlocksPerScreenCol)*16
								var BlockYPosition = Math.floor((BlockIndexer % BlocksPerScreenCol)/16)
								var BlockXPosition = ScreenColumnPassed+(BlockIndexer % 16)
								
								IndexToCoordsOutput += "Position: ($" + BlockXPosition.toString(16) + ", $" + BlockYPosition.toString(16) + ")"
						} else {
							//Indicate that index points to past the last block
								IndexToCoordsOutput = "<font color='red'>Index points beyond the last block. Valid index is from $0 to $" + (TotalNumberOfBlocksInLevel-1).toString(16) + "</font>"
						}
					//Output:
						document.getElementById("IndexToCoords").innerHTML = IndexToCoordsOutput
				}
	}


	function clamp(num, min, max) {
		return num <= min ? min : num >= max ? max : num;
	}
</script>